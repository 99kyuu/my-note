<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="maximum-scale=1.0, minimum-scale=1.0, user-scalable=0, initial-scale=1.0, width=device-width"/>
		<meta name="format-detection" content="telephone=no, email=no, date=no, address=no">
		<title>触摸事件</title>
		<style media="screen">
			*{ padding: 0; margin: 0; }
			.wrap{ width: 100%; height: 15em; background-color: #333; line-height: 15em; text-align: center; color: #fff; }
		</style>
	</head>
<body>
	<div class="wrap">
		<p>slider</p>
	</div>
</body>
<script type="text/javascript">
	function touch (obj, type, fn) {
		//滑动范围在5x5内则做点击处理，s是开始，e是结束
		var init = {
			x: 5,
			y: 5,
			sx: 0,
			sy: 0,
			ex: 0,
			ey: 0
		};
		var sTime = 0,eTime = 0;
		type = type.toLowerCase();
		obj.addEventListener("touchstart", function() {
			sTime = new Date().getTime();
			init.sx = event.targetTouches[0].pageX;
			init.sy = event.targetTouches[0].pageY;
			init.ex = init.sx;
			init.ey = init.sy;
			if (type.indexOf("start") != -1) fn();
		}, false)
		obj.addEventListener("touchmove", function() {
			event.preventDefault(); //阻止触摸时浏览器的缩放、滚动条滚动
			init.ex = event.targetTouches[0].pageX;
			init.ey = event.targetTouches[0].pageY;
			if (type.indexOf("move") != -1) fn();
		}, false)
		obj.addEventListener("touchend", function() {
			var changeX = init.sx - init.ex;
			var changeY = init.sy - init.ey;
			if (Math.abs(changeX) > Math.abs(changeY) && Math.abs(changeY) > init.y) {
				//左右事件
				if (changeX > 0) {
					if (type.indexOf("left") != -1) fn();
				} else {
					if (type.indexOf("right") != -1) fn();
				}
			} else if (Math.abs(changeY) > Math.abs(changeX) && Math.abs(changeX) > init.x) {
				//上下事件
				if (changeY > 0) {
					if (type.indexOf("top") != -1) fn();
				} else {
					if (type.indexOf("down") != -1) fn();
				}
			} else if (Math.abs(changeX) < init.x && Math.abs(changeY) < init.y) {
				eTime = new Date().getTime();
				//点击事件，此处根据时间差细分下
				if ((eTime - sTime) > 300) {
					if (type.indexOf("long") != -1) fn(); //长按
				} else {
					if (type.indexOf("click") != -1) fn(); //当点击处理
				}
			}
			if (type.indexOf("end") != -1) func();
			console.log(eTime-sTime);
		}, false);
	};
	var _el = document.querySelector('.wrap');
	// touch(_el, 'start', () => {
	// 	console.log('触摸开始');
	// })
	// touch(_el, 'move', () => {
	// 	console.log('触摸移动');
	// })
	touch(_el, 'left', () => {
		console.log('往左滑动');
	})
	touch(_el, 'right', () => {
		console.log('往右滑动');
	})
	touch(_el, 'top', () => {
		console.log('往上滑动');
	})
	touch(_el, 'down', () => {
		console.log('往下滑动');
	})
	touch(_el, 'long', () => {
		console.log('长摁');
	})
	touch(_el, 'click', () => {
		console.log('点击');
	})
</script>

</html>
